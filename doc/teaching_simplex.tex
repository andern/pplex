\documentclass[ukenglish]{nik}
\usepackage{mathptm}
\usepackage{hyperref}
\usepackage{amsfonts,amsmath,amssymb,amstext}
\usepackage{latexsym}
\usepackage{url,alltt}

\newcommand{\va}{\mathit{variable}}
\newcommand{\Fa}{\mathrm{F}}
\newcommand{\TEXT}{{\mathrm{TEXT}}}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\Int}{\mathbb{Z}}
\newcommand{\Rat}{\mathbb{Q}}
\newcommand{\Rea}{\mathbb{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\ra}{\rightarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\seg}[2]{[#1.\,.#2]}
\newcommand{\pair}[2]{\langle #1,#2\rangle}
\newcommand{\der}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\plusD}[1]{#1+\Delta{#1}}
\newcommand{\dD}[1]{\Delta{#1}}
\newcommand{\range}{\mathit{range}}
\newcommand{\oa}{\overline{a}}
\newcommand{\ob}{\overline{b}}
\newcommand{\oc}{\overline{c}}
\newcommand{\oz}{\overline{\zeta}}
\newcommand{\ea}{\epsilon_1}
\newcommand{\eb}{\epsilon_2}
\newcommand{\ec}{\epsilon_3}
\newcommand{\ba}{\frac{100}{2}b_1}
\newcommand{\bb}{\frac{10}{2}b_2}
\newcommand{\bc}{\frac{1}{2}b_3}
\newcommand{\binomsq}[2]{\left[\begin{array}{c}#1\\#2\end{array}\right]}



\begin{document}

\title{Teaching the Simplex Method}

\author{
Joanna Bauer\thanks{University of Bergen, Department of Informatics, P.O.Box 7803, N-5020 Bergen, Norway}
\and
Marc Bezem$^*$
\and
Andreas Halle$^*$}

%\maketitle

\begin{abstract}
We present software (\url{https://github.com/andern/pplex})
for the classroom presentation of the simplex method in linear programming.
\end{abstract}

\section{Motivation}
Linear Programming (LP) is the subfield of mathematical optimization where
the aim is to maximize a linear function under linear constraints. Such a problem
is called an LP problem. The simplex method is a family of algorithms for solving LP problems. 
Although there exist other algorithms for solving LP problems,
the simplex method is by far the one that is most used in practice.
It is also listed it as one of the top 10 algorithms of the twentieth century in
\cite{CiSaE2000}. Given the many applications of LP in economics and engineering and
management, it is deemed important to teach the simplex method to a wide range of
students. This range certainly includes students in applied mathematics and informatics,
but extends considerably beyond these groups. The fact that the simplex method is
taught to students with a weaker background in mathematics and algorithmics than
the abovementioned two groups should have important consequences for the way
in which we teach the simplex method.

In most courses on linear programming the need arises for demonstrating the simplex method step-by-step 
\emph{without being distracted by detailed calculations in elementary linear algebra}. Let us start by
introducing the simplex method by a simple example:
%and at the same time present some teaching issues at hand. 
\[
    \begin{array}{lrcrcrcrcrcrcr}
    \text{Maximize}  &    x &+&    y \\
    \text{subject to}&  2 x &+&    y &\leq&   6\\
    \text{and}&         7 x &+& 13 y &\leq&  40\\
    \text{and}       &    x &,&    y &\geq&0    &
    \end{array}
\]
where the variables $x$ and $y$ range over the real numbers.
A first observation is that there exist feasible solutions,
since the polyhedron given by the four (yes, four!) inequalities contains,
for example, the origin. Inequalities cannot be manipulated in the same
way as equations in linear algebra. A first step is therefore to
have linear equations in combination with simple inequalities of the form
$\mathit{variable}\geq 0$. For this purpose we introduce
two new variables, $u$ and $v$, measuring to what extent the first
two inequalities are satisfied. These new variables are commonly called
\emph{slack variables}. At the same time we introduce an extra variable
for the function $x+y$, the so-called \emph{objective function},
or \emph{objective} for short. Thus our LP problem is brought in
\emph{standard form}:
\[    
    \begin{array}{lcrcrcrcr}
      \zeta&=&   & &     x &+&     y & &  \\\hline
      u    &=& 6 &-&   2 x &-&     y & &  \\
      v    &=& 40&-&   7 x &-&  13 y & &  \\
      x,y,u,v  &\geq&0     & &  & &  & &    
    \end{array}
\]
Note that each edge of the polyhedron corresponds to a variable
being zero on that edge. Consequently,
vertices of the polyhedron are all given by a pair of
two distinct variables being zero. On the other hand, some of these
pairs take their values zero outside the polyhedron, f.e.\ , $x=v=0$.
Since the inequalities $x,y,u,v \geq 0$ are part of the standard, 
they are often omitted. This standard form is also called \emph{dictionary}
in \cite{Vanderbei}.

Geometric considerations lead to the observation that the
maximal value of the objective under the constraints (linear
equalities and inequalities of the form 
$\mathit{variable}\geq 0$ is attained in a vertex of the
polyhedron. The idea of the standard form is
that the variables on the right, the \emph{basic} variables, are zero,
the so-called \emph{basic solution}.
The basic solution enforces values to the variables on the left
given by the constants in the linear equations.
Since all variables must be non-negative, it is possible that
the the basic solution is not feasible. We have call a dictionary
(non-) feasible if the basic solution is (not) feasible.

In the example, we start in the origin $x=y=0$ and get
value 0 for the objective $\zeta = x + y$.
Clearly, there is room for improvement here, since actually 
the value 0 is the \emph{minimal} value of the objective
under the given constraints. How can one improve on this
value? The answer is: increase $x$ or $y$ or both.
In the simplex method one chooses one basic variable and
tries to increase it as much as possible, while keeping the
other basic variables constant zero.
Let's try to increase $x$ keeping $y=0$. How much can $x$ increase?
We see that $0 \leq u = 6 -2x-y$ allows us to increase $x$ to $3$,
and that the other linear equation allows an even larger increase. Since both
$u\geq 0$ and $v\geq 0$ must be respected, we increase $x$ to $3$,
thereby getting $u=0$ as a consequence. Moreover the objective $x+y$ becomes 3.

With value increased to $3$, $x$ doesn't qualify as a basic variable anymore.
Fortunately, the variable $u$ has become zero. Interchanging the roles of
$x$ and $u$ as basic and non-basic variable, respectively, restores 
the invariant of the standard form. The first equation $u = 6 -2x-y$ makes it
possible to express $x$ in $u,y$ such that $x$ can be eliminated from the
right-hand side of the standard form. The equation $u = 6 -2x-y$ is
called the \emph{pivot} and the operation of interchanging the roles of
a basic and a non-basic variable is called \emph{pivoting}.
Technically, pivoting is done by standard row operations in linear algebra. 
The new dictionary becomes:
\[    
    \begin{array}{lcrcrcrcr}
      \zeta&=& 3 &-& 0.5 u &+& 0.5 y & &  \\\hline
      x    &=& 3 &-& 0.5 u &-& 0.5 y & &  \\
      v    &=& 19&+& 3.5 u &-& 9.5 y & &  \\

    \end{array}
\]
This still looks good, due to the simplicity of the example.
However, in the next step things are getting worse. The next step
starts by the observation that the objective would improve if we 
increase $y$ while keeping $u$ constant zero. We see that
$0\leq v = 19 + 3.5u - 9.5y$ allows us to increase $y$ to $2$,
and that the other linear equation allows an even larger increase.
Hence we swap $y$ and $v$ and get,
again by standard row operations, the new dictionary:
\[    
    \begin{array}{lcrcrcrcr}
      \zeta&=& 4 &-& \frac{6}{19} u &-& \frac{1}{19} v &\vphantom{\frac{|}{|}} &  \\\hline
      x    &=& 2 &-&\frac{13}{19} u &+& \frac{1}{19} v &\vphantom{\frac{|}{|}} &  \\
      y    &=& 2 &+& \frac{7}{19} u &-& \frac{1}{19} v &\vphantom{\frac{|}{|}} &  \\
    \end{array}
\]
Observe that all dictionaries obtained under way are equivalent,
as the row operations could be reversed. 
The good news is that we have found the maximum, as the coefficients of
both (now) basic variables $u$ and $v$ are negative. The maximum value $4$
of the objective is attained in the point $x=y=2$. These values are clearly
integers by the design of the example, and could also be obtained in a geometric
way (see the next section). Less good news is that obtaining the last dictionary
was a rather painful (but still useful) exercise on the blackboard.
%And this already in a very simple example!

An interested and clever student may now ask the question: 
Can't we start with $y$ instead of with $x$?
Oops, the example has not been designed to start with $y$, 
but of course this very good question deserves a detailed answer.
Our hero, the lecturer starts boldly calculating on the blackboard.
Clearly, $0\leq v = 40 - 7x -13y$ allows us to increase $y$ to $\frac{40}{13}$,
and the other linear equation allows an even larger increase. Hence we swap $y$ and $v$ and get,
again by standard row operations, the new dictionary:
\[    
    \begin{array}{lcrcrcrcr}
      \zeta&=& \frac{40}{13} &+& \frac{6}{13} x &-& \frac{1}{13} v &\vphantom{\frac{|}{|}} &  \\\hline
      u    &=& \frac{38}{13} &-&\frac{19}{13} x &+& \frac{1}{13} v &\vphantom{\frac{|}{|}} &  \\
      y    &=& \frac{40}{13} &-& \frac{7}{13} x &-& \frac{1}{13} v &\vphantom{\frac{|}{|}} &  \\
    \end{array}
\]
At this point the lecturer almost regrets his willingness to answer the student's
question in detail, but manages as by miracle to finally produce the following dictionary
\[    
    \begin{array}{lcrcrcrcr}
      \zeta&=& 4 &-& \frac{6}{19} u &-& \frac{1}{19} v &\vphantom{\frac{|}{|}} &  \\\hline
      x    &=& 2 &-&\frac{13}{19} u &+& \frac{1}{19} v &\vphantom{\frac{|}{|}} &  \\
      y    &=& 2 &+& \frac{7}{19} u &-& \frac{2}{19} v &\vphantom{\frac{|}{|}} &  \\
    \end{array}
\]
A Happy End? Not yet. Some attentive student points out that the two final dictionaries
are not completely identical and asks for an explanation. After some discussion, it turns
out that the fraction $\frac{2}{19}$ in the (last) final dictionary is correct,
and that the corresponding fraction $\frac{1}{19}$ in the (previous) final dictionary was wrong.
The mistake may have gone unnoticed, since it doesn't spoil the answer, the maximum stays
$4$ at $x=y=2$. However, the mistake may have confused the interested student who tries
to understand the details.

What do we conclude form the above example? It is not entirely useless to do some explicit
linear algebra calculations. However, linear algebra should be a prerequisite for a course
in linear programming. The details of linear algebra should not distract from the important
issues in linear programming. These issues are:
\begin{itemize}
\item The choice of the pivot.
\item What to do if the basic solution is not feasible?
\item Duality theory.
\item Efficiency issues.
\item Sensitivity analysis.
\item Important special cases such as network problems.
\end{itemize}
Even for simple examples it is unnatural (and often impossible)
to design them in such a way that the linear algebra calculations stay simple.
It is much better to have a computerized tool for these calculations. Such a tool makes
it also possible to deal with larger, more interesting examples. 

This paper is organized as follows. In the next section we discuss the importance of
geometry for linear programming. In Section~\ref{} we introduce our tool \url{pplex}.
We conclude by discussing future work in Section~\ref{}.

%\section{Joanna on Geometry}

\section{A tool for teaching the Simplex method}
Our tool has the name \url{pplex},
which stands for a \emph{pedagogical implementation of the Simplex method}.
It is open-source \cite{pplex} and freely distributed under the 
GNU General Public License \cite{GNUGPL}.
It runs under Java version xx, so it is portable to any (supporting) platform.
We'll make an effort to keep it up to date and will support future standard
formats for LP problems upon request.

We start by demonstrating \url{pplex} on the example from the introduction.
The input file for this example looks:
\begin{alltt}
\input{../input/nik2.lps}
\end{alltt}
After launching \url{pplex} a prompt \verb|pplex>| is written.
We read the above input file, which is confirmed OK:
\begin{verbatim}
pplex> read input/nik2.lps
Read input/nik2.lps OK.
\end{verbatim}
To show the dictionary of this problem one writes after the prompt:
\begin{alltt}
pplex> show primal
 \(\zeta\) =       +     x +      y
w1 =  6.00 - 2.00x -      y
w2 = 40.00 - 7.00x - 13.00y
\end{alltt}
Results are standard displayed in two decimals, whereas internally
calculations are performed in double(?) precision arithmetic.
We can now let \url{pplex} generate the next dictionary by specifying
the variable by its \emph{column} ($1$ for $x$ and $2$ for $y$)
and the linear equation by its \emph{row}. (These numbers correspond to
the indices in the matrix representation of the LP-problem.)
Here comes the command and the resulting dictionary:
\begin{alltt}
pplex> pivot 1 1
 \(\zeta\) =  3.00 - 0.50w1 + 0.50y
 x =  3.00 - 0.50w1 - 0.50y
w2 = 19.00 + 3.50w1 - 9.50y
\end{alltt}
The final (optimal) dictionary is produced after the next command:
\begin{alltt}
pplex> pivot 2 2
 \(\zeta\) = 4.00 - 0.32w1 - 0.05w2
 x = 2.00 - 0.68w1 + 0.05w2
 y = 2.00 + 0.37w1 - 0.11w2
\end{alltt}
Responding to the question of the student about starting with variable $y$, 
one can roll back to the first dictionary by two \verb|undo|'s and pivot
with $y$ and the second linear linear equation:
\begin{alltt}
pplex> undo

pplex> undo

pplex> pivot 2 2
 \(\zeta\) = 3.08 + 0.46x - 0.08w2
w1 = 2.92 - 1.46x + 0.08w2
 y = 3.08 - 0.54x - 0.08w2
\end{alltt}
In an effortless way one now obtains the same final dictionary:
\begin{alltt}
pplex> pivot 1 1 
 \(\zeta\) = 4.00 - 0.32w1 - 0.05w2
 x = 2.00 - 0.68w1 + 0.05w2
 y = 2.00 + 0.37w1 - 0.11w2
\end{alltt}
Due to the double precision arithmetic, one obtains exactly the same result.

\section{Examples}
1. primal feasible

2. dual feasible but not primal

3. primal and dual infeasible

4. unbounded

5. cyclic

\section{Features}
Short overview of the software, dicussion of design decisions.

\section{Future extensions}




\bibliographystyle{abbrv}
\begin{thebibliography}{99}
\bibitem{CiSaE2000} Computing in Science and Engineering, volume 2, no. 1, 2000.

\bibitem{Vanderbei} R.J. Vanderbei, 
\emph{Linear Programming, Foundations and Extensions},
3rd edition, Kluwer, 2008.

\bibitem{pplex}
\url{https://github.com/andern/pplex/}
\bibitem{GNUGPL}
\url{http://www.gnu.org/licenses/}
%\bibitem{WalkerAMM}
%Peter Walker, A Lemma on Divisibility. \emph{American Mathematical Monthly}
%{\bf 115}(4):338.
\end{thebibliography}



\end{document}
